webpackJsonp([15],{157:function(a,e,t){function n(a){t(470)}var i=t(37)(t(316),t(549),n,"data-v-765d220a",null);a.exports=i.exports},316:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{searchOptions:{searchParams:{customerName:"",brandName:"",clothingLevel:"",rangeName:"",name:"",dateRange:""},options:{customerNameOptions:[],brandNameOptions:[],clothingLevelOptions:[],rangeNameOptions:[],planNameOptions:[]}},totalTableData:[],tableData:[],selectedTableData:[],pages:0,pagination:{currentPage:1,pageSizes:[10,20,30,40,50],pageSize:10,total:0}}},created:function(){var a=this,e=this;console.log("进入未提交计划页面"),this.$axios.get(window.$config.HOST+"/baseInfoManagement/getCustomerName").then(function(e){a.searchOptions.options.customerNameOptions=e.data}).catch(function(a){console.log("初始化获取客户名称失败")}),e.$axios.get(window.$config.HOST+"/baseInfoManagement/getClothingLevelName").then(function(e){a.searchOptions.options.clothingLevelOptions=e.data}).catch(function(a){console.log("初始化获取服装层次名称失败")}),this.$axios.get(window.$config.HOST+"/baseInfoManagement/getBrandName").then(function(e){a.searchOptions.options.brandNameOptions=e.data}).catch(function(a){console.log("初始化获取品牌名称失败")});this.$axios.get(window.$config.HOST+"/planManagement/getPlanList",{params:{stage:"predict"}}).then(function(e){e.data.forEach(function(e){1===e.type&&1===e.state&&a.totalTableData.push(e),a.pagination.total=a.totalTableData.length;var t=(a.pagination.currentPage-1)*a.pagination.pageSize,n=t+a.pagination.pageSize>a.pagination.total?a.pagination.total:t+a.pagination.pageSize;a.tableData=a.totalTableData.slice(t,n)})}).catch(function(a){console.log("初始化计划列表获取错误")})},methods:{handleSelectionChange:function(a){this.selectedTableData=a},handleSizeChange:function(a){this.pagination.pageSize=a,console.log("每页 "+a+" 条"),this.pagination.currentPage=1,this.handleSearch()},handleCurrentChange:function(a){console.log("当前页: "+a),this.pagination.currentPage=a,this.handleSearch()},changeDate:function(a){if(console.log(a),a){var e=a.getFullYear(),t=a.getMonth()+1;t=t<10?"0"+t:t;var n=a.getDate();n=n<10?"0"+n:n;var i=a.getHours(),o=a.getMinutes();o=o<10?"0"+o:o;var s=a.getSeconds();return s=o<10?"0"+s:s,e+"-"+t+"-"+n+" "+i+":"+o+":"+s}return null},handleSearch:function(){var a=this,e={customerId:""===this.searchOptions.searchParams.customerName?null:this.searchOptions.searchParams.customerName,brandId:""===this.searchOptions.searchParams.brandName?null:this.searchOptions.searchParams.brandName,id:""===this.searchOptions.searchParams.name?null:this.searchOptions.searchParams.name,clothingLevelId:""===this.searchOptions.searchParams.clothingLevelName?null:this.searchOptions.searchParams.clothingLevelName,startDate:this.changeDate(this.searchOptions.searchParams.dateRange[0]),endDate:this.changeDate(this.searchOptions.searchParams.dateRange[1])};console.log(e),this.$axios.get(window.$config.HOST+"/planManagement/getPlanList",e).then(function(e){e.data.forEach(function(e){1===e.type&&1===e.state&&a.totalTableData.push(e),a.pagination.total=a.totalTableData.length;var t=(a.pagination.currentPage-1)*a.pagination.pageSize,n=t+a.pagination.pageSize>a.pagination.total?a.pagination.total:t+a.pagination.pageSize;a.tableData=a.totalTableData.slice(t,n)})}).catch(function(e){a.$message.error("搜索失败!")})},toPlanDetail:function(a){param={flag:0,goback:"predictPlanMaking",client:a.customerName,brand:a.brandName,series:a.rangeName,id:a.id,plantype:a.type,planobj:a.planObject,TopPlan:a.parentId,TopPlanName:a.parentName?a.parentName:"根计划",planName:a.name,projectType:a.projectType,number:a.number,dataStart:a.startDate,dataEnd:a.endDate,productDate:a.productDate,productDateType:a.productDateType,productId:a.productId,proposal:a.proposal,note:a.note,description:a.description},that.$router.push({name:"planMakeIndex",params:param})},submitPredictPlan:function(){var a=this;this.$confirm("是否确认提交计划?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("提交计划:"),console.log(a.selectedTableData),a.selectedTableData.forEach(function(e){a.$axios.post(window.$config.HOST+"/planManagement/submitPlan",{id:e.id}).then(function(t){t.data<0?a.$message.error("提交失败,失败代码:"+resData.errcode):(a.$message({message:"成功提交!",type:"success"}),console.log(e.name+"提交成功"))}).catch(function(t){a.$message.error(e.name+"提交失败!")})})}).catch(function(){a.$message({message:"取消提交!",type:"info"})})},editPredictPlan:function(a){param={flag:1,goback:"predictPlanMaking",client:a.customerName,brand:a.brandName,series:a.rangeName,id:a.id,plantype:a.type,planobj:a.planObject,TopPlan:a.parentId,TopPlanName:a.parentName?a.parentName:"根计划",planName:a.name,projectType:a.projectType,number:a.number,dataStart:a.startDate,dataEnd:a.endDate,productDate:a.productDate,productDateType:a.productDateType,productId:a.productId,proposal:a.proposal,note:a.note,description:a.description},that.$router.push({name:"planMakeIndex",params:param})},deletePredictPlan:function(a){var e=this;this.$confirm("是否确认删除计划"+a.name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("删除计划"+a.id),e.$axios.delete(window.$config.HOST+"/planManagement/deletePlan",{params:{id:a.id}}).then(function(a){a.data<0?e.$message.error("删除失败,失败代码:"+-resData.errcode):e.$message({message:"成功删除!",type:"success"})}).catch(function(a){e.$message.error("删除失败!")})}).catch(function(){e.$message({message:"取消删除!",type:"info"})})}}}},423:function(a,e,t){e=a.exports=t(123)(!0),e.push([a.i,".box-card[data-v-765d220a]{margin:20px 50px;padding:0 20px}.box-card .bar[data-v-765d220a]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.box-card .bar .title[data-v-765d220a]{font-size:14px;min-width:75px;text-align:center}.box-card .bar .el-input[data-v-765d220a],.box-card .bar .el-select[data-v-765d220a]{width:300px;min-width:75px}.box-card .block[data-v-765d220a]{padding:30px 0;text-align:center}","",{version:3,sources:["/home/titanxu/Desktop/planui/src/page/planManagement/predictPlanMaking.vue"],names:[],mappings:"AACA,2BACE,iBAAkB,AAClB,cAAgB,CACjB,AACD,gCACE,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,8BAA+B,AAC/B,6BAA8B,AAC1B,uBAAwB,AACpB,mBAAoB,AAC5B,yBAA0B,AACtB,sBAAuB,AACnB,mBAAoB,AAC5B,UAAY,CACb,AACD,uCACE,eAAgB,AAChB,eAAgB,AAChB,iBAAmB,CACpB,AAKD,qFAHE,YAAa,AACb,cAAgB,CAKjB,AACD,kCACE,eAAgB,AAChB,iBAAmB,CACpB",file:"predictPlanMaking.vue",sourcesContent:["\n.box-card[data-v-765d220a] {\n  margin: 20px 50px;\n  padding: 0 20px;\n}\n.box-card .bar[data-v-765d220a] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  width: 100%;\n}\n.box-card .bar .title[data-v-765d220a] {\n  font-size: 14px;\n  min-width: 75px;\n  text-align: center;\n}\n.box-card .bar .el-input[data-v-765d220a] {\n  width: 300px;\n  min-width: 75px;\n}\n.box-card .bar .el-select[data-v-765d220a] {\n  width: 300px;\n  min-width: 75px;\n}\n.box-card .block[data-v-765d220a] {\n  padding: 30px 0;\n  text-align: center;\n}\n"],sourceRoot:""}])},470:function(a,e,t){var n=t(423);"string"==typeof n&&(n=[[a.i,n,""]]),n.locals&&(a.exports=n.locals);t(124)("109df29e",n,!0)},549:function(a,e){a.exports={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"body"},[t("el-card",{staticClass:"box-card"},[t("el-row",{staticStyle:{"margin-top":"5px"},attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"bar"},[t("div",{staticClass:"title"},[a._v("客户名称")]),a._v(" "),t("el-select",{attrs:{clearable:""},model:{value:a.searchOptions.searchParams.customerName,callback:function(e){a.$set(a.searchOptions.searchParams,"customerName",e)},expression:"searchOptions.searchParams.customerName"}},a._l(a.searchOptions.options.customerNameOptions,function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),t("el-col",{attrs:{span:8}},[t("div",{staticClass:"bar"},[t("div",{staticClass:"title"},[a._v("品牌")]),a._v(" "),t("el-select",{attrs:{clearable:""},model:{value:a.searchOptions.searchParams.brandName,callback:function(e){a.$set(a.searchOptions.searchParams,"brandName",e)},expression:"searchOptions.searchParams.brandName"}},a._l(a.searchOptions.options.brandNameOptions,function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),t("el-col",{attrs:{span:8}},[t("div",{staticClass:"bar"},[t("div",{staticClass:"title"},[a._v("服装层次")]),a._v(" "),t("el-select",{attrs:{clearable:""},model:{value:a.searchOptions.searchParams.clothingLevelName,callback:function(e){a.$set(a.searchOptions.searchParams,"clothingLevelName",e)},expression:"searchOptions.searchParams.clothingLevelName"}},a._l(a.searchOptions.options.clothingLevelOptions,function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)])],1),a._v(" "),t("el-row",{staticStyle:{"margin-top":"25px","margin-bottom":"5px"},attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"bar"},[t("div",{staticClass:"title"},[a._v("计划名称")]),a._v(" "),t("el-select",{model:{value:a.searchOptions.searchParams.name,callback:function(e){a.$set(a.searchOptions.searchParams,"name",e)},expression:"searchOptions.searchParams.name"}},a._l(a.searchOptions.options.planNameOptions,function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}})}))],1)]),a._v(" "),t("el-col",{attrs:{span:13}},[t("div",{staticClass:"bar"},[t("div",{staticClass:"title"},[a._v("制定时间")]),a._v(" "),t("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:a.searchOptions.searchParams.dateRange,callback:function(e){a.$set(a.searchOptions.searchParams,"dateRange",e)},expression:"searchOptions.searchParams.dateRange"}})],1)]),a._v(" "),t("el-col",{attrs:{span:1}},[t("div",{staticClass:"bar"},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){a.handleSearch()}}},[a._v("搜索")])],1)])],1)],1),a._v(" "),t("el-card",{staticClass:"box-card"},[t("div",[t("el-button",{attrs:{type:"primary"},on:{click:a.submitPredictPlan}},[a._v("提交预测计划")])],1),a._v(" "),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:a.tableData,"max-height":"550",stripe:!0},on:{"selection-change":a.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{width:"50",type:"index",label:"序号",align:"center"}},[a._v(">")]),a._v(" "),a._e(),a._v(" "),t("el-table-column",{attrs:{prop:"number",label:"预测编号",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"name",label:"计划名称",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"rangeNumber",label:"系列编号",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"rangeName",label:"系列名称",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"customerName",label:"客户名称",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"brandName",label:"品牌",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"clothingLevelName",label:"服装层次",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"createrName",label:"添加人",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{prop:"deptName",label:"部门",align:"center"}}),a._v(" "),t("el-table-column",{attrs:{fixed:"right",width:"200",align:"center"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){a.toPlanDetail(e.row)}}},[a._v("查看")]),a._v(" "),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){a.editPredictPlan(e.row)}}},[a._v("修改")]),a._v(" "),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){a.deletePredictPlan(e.row)}}},[a._v("删除")])]}}])})],1)],1),a._v(" "),t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"current-page":a.pagination.currentPage,"page-sizes":a.pagination.pageSizes,"page-size":a.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:a.pagination.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange,"update:currentPage":function(e){a.$set(a.pagination,"currentPage",e)}}})],1)])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=15.10c7e7b343aec4676ff1.js.map